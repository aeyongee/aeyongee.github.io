---
title: 쿠버네티스 세팅 후 확인하기
date: 2026-02-03 22:00:00 
categories: [DevOps, 쿠버네티스]
tags: [쿠버네티스]
---

# 설치 스펙
- Rocky Linux 9.2 arm64
- UTM 4.6.5

<br>

# 쿠버네티스 설치 : Worker + Master (공통)
1. rocky linux 기본 설정
- 패키지 업데이트
- 타임존 설정

2. kubeadm 설치 사전작업
- 방화벽 해제
- Swap 비활성화

3. 컨테이너 런타임 설치
- iptables 세팅
- containerd 설치
    - docker engine 설치
- cri 활성화

4. kubeadm 설치
- repo 설정
- SELinux 설정
- kubelet, kubeadm, kubectl 패키지 설치


<br>

# Master 노드 세팅
1. kubeadm으로 클러스터 생성
- 클러스터 초기화
    - Pod Network 세팅
- kubectl 사용 설정
- CNI Plugin 설치 (calico)
- Master에 Pod 생성 가능하도록 설정

2. 쿠버네티스 편의기능 설치
- kubectl 자동완성 기능
- Dashboard 설치
- Metrics Server 설치

<br>

## 세팅 후, 대시보드 접속 결과
![쿠버네티스 대시보드](/assets/post/k8s_dashboard_260203.png)


------------

# 세팅 환경 확인하기
1. Rocky Linux 버전 확인
- `cat /etc/*-release`
![Linux 버전 확인](/assets/post/os_release_260203.png)

2. Hostname 확인
- `hostname`
![hostname 확인](/assets/post/hostname_260203.png)

3. Network 확인
- `ip addr` 
![네트워크 확인](/assets/post/network_260203.png)

4. CPU, Memory 확인
- CPU : `lscpu` 
- Memory : `free -h` 
![cpu와memory확인](/assets/post/cpu_memory_260203.png)

5. 타임존 설정 확인
- `timedatectl` 
![타임존확인](/assets/post/timedatectl_260203.png)

6. 방화벽 해제 확인
- `systemctl status firewalld` 
![방화벽해제확인](/assets/post/firewalld_260203.png)

7. Swap 비활성화 확인
- `free` 
- `cat /etc/fstab | grep swap` 
![Swap비활성화확인](/assets/post/swap_260203.png)

8. iptables 세팅 확인
- 설정 세팅 확인
    - `cat /etc/modules-load.d/k8s.conf`
    - `cat /etc/sysctl.d/k8s.conf`
![iptables-설정](/assets/post/iptables_setting_260203.png)

- 모듈 적재 확인
    - `lsmod | grep overlay`
    - `lsmod | grep br_netfilter`
![iptables-모듈](/assets/post/iptables-module_260203.png)

9. docker repo 설정 확인
- `yum repolist enabled`
![docker repo](/assets/post/docker-repo_260203.png)

10. containerd 설치 확인
- `systemctl status containerd`
![containerd 확인](/assets/post/containerd_260203.png)

11. 설치 가능한 버전의 containerd.io 리스트 확인
- `yum list containerd.io --showduplicates | sort -r` 
![containerd.io 리스트](/assets/post/containerd-io_260203.png)

12. cri 활성화 확인
- `cat /etc/containerd/config.toml`
![cri활성화](/assets/post/cri-option_260203.png)

13. kubelet cgroup 확인
- configmap :  `kubectl get -n kube-system cm kubelet-config -o yaml`
- kubelet : `cat /var/lib/kubelet/config.yaml`

![configmap](/assets/post/systemd-1_260203.png)
![kubelet](/assets/post/containerd-2_260203.png)

14. repo 설정 확인
- `yum repolist enabled`
![repo 확인](/assets/post/repo_260203.png)

15. SELinux 설정 확인
- `cat /etc/selinux/config`
- `sestatus`
![selinux확인](/assets/post/selinux_260203.png)

16. kubelet, kubeadm, kubectl 설치 확인
- 버전 보기
    - `kubeadm version`
    - `kubectl version`
- 상태 보기
    - `systemctl status kubelet`
- 설정 파일 위치
    - `cat /var/lib/kubelet/config.yaml`
- 로그 조회
    - `journalctl -u kubelet | tail -10`

![chk1](/assets/post/version_chk_1_260203.png)
![chk2](/assets/post/version_chk_2_260203.png)

17. 설치 가능한 버전의 kubeadm 리스트 확인
- `yum list --showduplicates kubeadm --disableexcludes=kubernetes` 
![chk3](/assets/post/version_chk3_260203.png)

18. 클러스터 상태 확인
- master node 상태 확인
    - `kubectl get node` 
- pod network cidr 설정 확인
    - `kubectl cluster-info dump | grep -m 1 cluster-cidr` 
- apiserver advertise address 적용 확인
    - `kubectl cluster-info`
- kubernetes component pod 확인
    - `kubectl get pods -n kube-system`

![chk4](/assets/post/version_chk4_260203.png)

19. 인증서 설정 확인
- `cat ~/.kube/config`
![config](/assets/post/config_260203.png)


20. calico pod & pod network cidr 확인
- Calico Pod 확인
    - `kubectl get -n calico-system pod` 
    - `kubectl get -n calico-apiserver pod` 
- pod network cidr 확인
    - `kubectl get installations.operator.tigera.io default -o yaml  | grep cidr` 

![calico](/assets/post/calico_260203.png)

21. master node에 Taint 해제 확인
- `kubectl describe nodes | grep Taints` 
![taints](/assets/post/taints_260203.png)

22. kubectl 기능 설정 확인
- `cat ~/.bashrc` 
![kubectl](/assets/post/kubectl_260203.png)

23. dashboard 설치 확인
- `kubectl get pod -n kubernetes-dashboard` 
![dashboard](/assets/post/dashboard_260203.png)

24. metrics server 설치 확인
- `kubectl get pod -n kube-system  | grep metrics` 
- `kubectl top pod -A` 
![metrics](/assets/post/metrics_260203.png)



------

<br>



출처: 인프런 일프로 님 - [쿠버네티스 어나더 클래스-Spring 1, 2](https://www.inflearn.com/course/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EC%96%B4%EB%82%98%EB%8D%94-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%A7%80%EC%83%81%ED%8E%B8-sprint1?cid=330869)